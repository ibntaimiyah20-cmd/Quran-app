<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quran Ultimate App</title>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

<style>
body{
  margin:0;
    font-family:Arial;
      background:#f2f2f2;
        transition:0.3s;
        }

        header{
          background:#0c8f8f;
            color:white;
              padding:15px;
                text-align:center;
                  font-weight:bold;
                    position:fixed;
                      width:100%;
                        top:0;
                        }

                        header i{
                          position:absolute;
                            right:15px;
                              top:18px;
                                cursor:pointer;
                                }

                                .page{
                                  display:none;
                                    padding:80px 15px 90px;
                                    }

                                    .page.active{
                                      display:block;
                                      }

                                      .result{
                                        background:white;
                                          padding:12px;
                                            border-radius:10px;
                                              margin-bottom:10px;
                                                cursor:pointer;
                                                }

                                                input{
                                                  width:100%;
                                                    padding:10px;
                                                      border-radius:8px;
                                                        border:1px solid #ccc;
                                                          margin-bottom:10px;
                                                          }

                                                          button{
                                                            padding:10px 15px;
                                                              border:none;
                                                                border-radius:8px;
                                                                  background:#0c8f8f;
                                                                    color:white;
                                                                      cursor:pointer;
                                                                      }

                                                                      footer{
                                                                        position:fixed;
                                                                          bottom:0;
                                                                            width:100%;
                                                                              height:60px;
                                                                                background:white;
                                                                                  border-top:1px solid #ddd;
                                                                                    display:flex;
                                                                                      justify-content:space-around;
                                                                                        align-items:center;
                                                                                        }

                                                                                        .nav-btn{
                                                                                          text-align:center;
                                                                                            font-size:12px;
                                                                                              color:#666;
                                                                                                cursor:pointer;
                                                                                                }

                                                                                                .nav-btn i{
                                                                                                  display:block;
                                                                                                    font-size:20px;
                                                                                                    }

                                                                                                    .nav-btn.active{
                                                                                                      color:#0c8f8f;
                                                                                                        font-weight:bold;
                                                                                                        }

                                                                                                        /* DARK MODE */
                                                                                                        .dark{
                                                                                                          background:#121212;
                                                                                                            color:white;
                                                                                                            }

                                                                                                            .dark header{
                                                                                                              background:#1f1f1f;
                                                                                                              }

                                                                                                              .dark .result{
                                                                                                                background:#1e1e1e;
                                                                                                                  color:white;
                                                                                                                  }

                                                                                                                  .dark footer{
                                                                                                                    background:#1f1f1f;
                                                                                                                      border-top:1px solid #333;
                                                                                                                      }
                                                                                                                      </style>
                                                                                                                      </head>

                                                                                                                      <body>

                                                                                                                      <header>
                                                                                                                        Quran Ultimate App
                                                                                                                          <i class="fa-solid fa-microphone" onclick="startVoice()"></i>
                                                                                                                          </header>

                                                                                                                          <!-- HOME -->
                                                                                                                          <div id="home" class="page active">
                                                                                                                            <h3>Welcome</h3>
                                                                                                                              <div class="result">ðŸŽ¤ Use voice to search Quran</div>
                                                                                                                                <div class="result">ðŸ”Š Click ayah to play audio</div>
                                                                                                                                </div>

                                                                                                                                <!-- QURAN -->
                                                                                                                                <div id="quran" class="page">
                                                                                                                                  <h3>Search Quran</h3>
                                                                                                                                    <input id="searchInput" placeholder="Type or speak..." />
                                                                                                                                      <div id="results"></div>
                                                                                                                                      </div>

                                                                                                                                      <!-- TOOLS -->
                                                                                                                                      <div id="tools" class="page">
                                                                                                                                        <h3>Prayer Times</h3>
                                                                                                                                          <button onclick="getPrayerTimes()">Load Prayer Times</button>
                                                                                                                                            <div id="prayerResult"></div>

                                                                                                                                              <h3>Tasbeeh Counter</h3>
                                                                                                                                                <div class="result" id="countDisplay">0</div>
                                                                                                                                                  <button onclick="increase()">+1</button>
                                                                                                                                                    <button onclick="reset()">Reset</button>
                                                                                                                                                    </div>

                                                                                                                                                    <!-- SETTINGS -->
                                                                                                                                                    <div id="settings" class="page">
                                                                                                                                                      <h3>Settings</h3>
                                                                                                                                                        <div class="result" onclick="toggleDark()">ðŸŒ™ Toggle Dark Mode</div>
                                                                                                                                                        </div>

                                                                                                                                                        <footer>
                                                                                                                                                          <div class="nav-btn active" onclick="showPage('home',this)">
                                                                                                                                                              <i class="fa-solid fa-house"></i>Home
                                                                                                                                                                </div>
                                                                                                                                                                  <div class="nav-btn" onclick="showPage('quran',this)">
                                                                                                                                                                      <i class="fa-solid fa-book-quran"></i>Quran
                                                                                                                                                                        </div>
                                                                                                                                                                          <div class="nav-btn" onclick="showPage('tools',this)">
                                                                                                                                                                              <i class="fa-solid fa-compass"></i>Tools
                                                                                                                                                                                </div>
                                                                                                                                                                                  <div class="nav-btn" onclick="showPage('settings',this)">
                                                                                                                                                                                      <i class="fa-solid fa-gear"></i>Settings
                                                                                                                                                                                        </div>
                                                                                                                                                                                        </footer>

                                                                                                                                                                                        <script>

                                                                                                                                                                                        /* PAGE SWITCH */
                                                                                                                                                                                        function showPage(id, btn){
                                                                                                                                                                                          document.querySelectorAll('.page')
                                                                                                                                                                                              .forEach(p=>p.classList.remove('active'));

                                                                                                                                                                                                document.getElementById(id).classList.add('active');

                                                                                                                                                                                                  document.querySelectorAll('.nav-btn')
                                                                                                                                                                                                      .forEach(b=>b.classList.remove('active'));

                                                                                                                                                                                                        if(btn) btn.classList.add('active');
                                                                                                                                                                                                        }

                                                                                                                                                                                                        /* DARK MODE */
                                                                                                                                                                                                        function toggleDark(){
                                                                                                                                                                                                          document.body.classList.toggle("dark");
                                                                                                                                                                                                          }

                                                                                                                                                                                                          /* LOAD QURAN */
                                                                                                                                                                                                          let data = [];

                                                                                                                                                                                                          async function loadQuran(){
                                                                                                                                                                                                            const res = await fetch("https://api.alquran.cloud/v1/quran/ar.alafasy");
                                                                                                                                                                                                              const json = await res.json();

                                                                                                                                                                                                                json.data.surahs.forEach(surah=>{
                                                                                                                                                                                                                    surah.ayahs.forEach(a=>{
                                                                                                                                                                                                                          data.push({
                                                                                                                                                                                                                                  text:a.text,
                                                                                                                                                                                                                                          surah:surah.number,
                                                                                                                                                                                                                                                  aya:a.numberInSurah,
                                                                                                                                                                                                                                                          audio:a.audio
                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                      });
                                                                                                                                                                                                                                                                      }

                                                                                                                                                                                                                                                                      loadQuran();

                                                                                                                                                                                                                                                                      /* SEARCH */
                                                                                                                                                                                                                                                                      const input = document.getElementById("searchInput");
                                                                                                                                                                                                                                                                      const results = document.getElementById("results");

                                                                                                                                                                                                                                                                      input.oninput = ()=>search(input.value);

                                                                                                                                                                                                                                                                      function search(word){
                                                                                                                                                                                                                                                                        results.innerHTML="";
                                                                                                                                                                                                                                                                          if(!word) return;

                                                                                                                                                                                                                                                                            data
                                                                                                                                                                                                                                                                              .filter(a=>a.text.includes(word))
                                                                                                                                                                                                                                                                                .slice(0,20)
                                                                                                                                                                                                                                                                                  .forEach(a=>{
                                                                                                                                                                                                                                                                                      results.innerHTML+=`
                                                                                                                                                                                                                                                                                            <div class="result" onclick="playAudio('${a.audio}')">
                                                                                                                                                                                                                                                                                                    ${a.text}<br>
                                                                                                                                                                                                                                                                                                            <small>Surah ${a.surah}:${a.aya}</small>
                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                      `;
                                                                                                                                                                                                                                                                                                                        });
                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                        /* AUDIO */
                                                                                                                                                                                                                                                                                                                        let currentAudio;

                                                                                                                                                                                                                                                                                                                        function playAudio(src){
                                                                                                                                                                                                                                                                                                                          if(currentAudio) currentAudio.pause();
                                                                                                                                                                                                                                                                                                                            currentAudio = new Audio(src);
                                                                                                                                                                                                                                                                                                                              currentAudio.play();
                                                                                                                                                                                                                                                                                                                              }

                                                                                                                                                                                                                                                                                                                              /* VOICE */
                                                                                                                                                                                                                                                                                                                              const SpeechRecognition =
                                                                                                                                                                                                                                                                                                                              window.SpeechRecognition || window.webkitSpeechRecognition;

                                                                                                                                                                                                                                                                                                                              const recognition = new SpeechRecognition();
                                                                                                                                                                                                                                                                                                                              recognition.lang = "ar-SA";

                                                                                                                                                                                                                                                                                                                              function startVoice(){
                                                                                                                                                                                                                                                                                                                                recognition.start();
                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                recognition.onresult = (e)=>{
                                                                                                                                                                                                                                                                                                                                  const text = e.results[0][0].transcript;
                                                                                                                                                                                                                                                                                                                                    input.value = text;
                                                                                                                                                                                                                                                                                                                                      showPage("quran");
                                                                                                                                                                                                                                                                                                                                        search(text);
                                                                                                                                                                                                                                                                                                                                        };

                                                                                                                                                                                                                                                                                                                                        /* PRAYER TIMES */
                                                                                                                                                                                                                                                                                                                                        function getPrayerTimes(){

                                                                                                                                                                                                                                                                                                                                          if(!navigator.geolocation){
                                                                                                                                                                                                                                                                                                                                              alert("Location not supported");
                                                                                                                                                                                                                                                                                                                                                  return;
                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                      navigator.geolocation.getCurrentPosition(async pos=>{

                                                                                                                                                                                                                                                                                                                                                          const lat = pos.coords.latitude;
                                                                                                                                                                                                                                                                                                                                                              const lon = pos.coords.longitude;

                                                                                                                                                                                                                                                                                                                                                                  const res = await fetch(
                                                                                                                                                                                                                                                                                                                                                                        `https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=2`
                                                                                                                                                                                                                                                                                                                                                                            );

                                                                                                                                                                                                                                                                                                                                                                                const data = await res.json();
                                                                                                                                                                                                                                                                                                                                                                                    const t = data.data.timings;

                                                                                                                                                                                                                                                                                                                                                                                        document.getElementById("prayerResult").innerHTML = `
                                                                                                                                                                                                                                                                                                                                                                                              <div class="result">Fajr: ${t.Fajr}</div>
                                                                                                                                                                                                                                                                                                                                                                                                    <div class="result">Dhuhr: ${t.Dhuhr}</div>
                                                                                                                                                                                                                                                                                                                                                                                                          <div class="result">Asr: ${t.Asr}</div>
                                                                                                                                                                                                                                                                                                                                                                                                                <div class="result">Maghrib: ${t.Maghrib}</div>
                                                                                                                                                                                                                                                                                                                                                                                                                      <div class="result">Isha: ${t.Isha}</div>
                                                                                                                                                                                                                                                                                                                                                                                                                          `;
                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                            /* TASBEEH */
                                                                                                                                                                                                                                                                                                                                                                                                                            let count = 0;

                                                                                                                                                                                                                                                                                                                                                                                                                            function increase(){
                                                                                                                                                                                                                                                                                                                                                                                                                              count++;
                                                                                                                                                                                                                                                                                                                                                                                                                                document.getElementById("countDisplay").innerText = count;
                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                function reset(){
                                                                                                                                                                                                                                                                                                                                                                                                                                  count = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                    document.getElementById("countDisplay").innerText = count;
                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                    </script>

                                                                                                                                                                                                                                                                                                                                                                                                                                    </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                    </html>